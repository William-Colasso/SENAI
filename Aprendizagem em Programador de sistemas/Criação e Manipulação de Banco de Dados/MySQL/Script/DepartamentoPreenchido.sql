create database exec_insert;

use exec_insert;

CREATE TABLE GRADE_SALARIAL (
ID_GRADE_SALARIAL INT NOT NULL,
MENOR_SALARIO DECIMAL(10,2) NOT NULL,
MAIOR_SALARIO DECIMAL(10,2) NOT NULL,
PRIMARY KEY(ID_GRADE_SALARIAL)
);

CREATE TABLE DEPARTAMENTO (
ID_DEPARTAMENTO INT NOT NULL,
NM_DEPARTAMENTO VARCHAR(30) NOT  NULL,
LOCALIZACAO VARCHAR(20) NOT NULL,
PRIMARY KEY(ID_DEPARTAMENTO)
);

CREATE TABLE EMPREGADO (
ID_EMPREGADO INT NOT NULL,
NM_EMPREGADO VARCHAR(45) NOT NULL,
FUNCAO VARCHAR(45) NOT NULL,
LIDER INTEGER NULL,
DATA_CONTRATACAO DATE NOT NULL,
SALARIO DECIMAL(10,2) NOT NULL,
COMISSAO DECIMAL(10,2) NULL,
ID_DEPARTAMENTO INTEGER NOT NULL,
PRIMARY KEY(ID_EMPREGADO), 
FOREIGN KEY(ID_DEPARTAMENTO) REFERENCES DEPARTAMENTO(ID_DEPARTAMENTO),
FOREIGN KEY(LIDER) REFERENCES EMPREGADO(ID_EMPREGADO)
);



INSERT INTO departamento (ID_DEPARTAMENTO, NM_DEPARTAMENTO, LOCALIZACAO) VALUES
(10, 'CONTÁBIL', 'NEW YORK'),
(20, 'PESQUISA E DESENVOLVIMENTO', 'DALLAS'),
(30, 'VENDAS', 'CHICAGO'),
(40, 'OPERAÇÕES', 'BOSTON');
    
    



INSERT INTO grade_salarial (ID_GRADE_SALARIAL, MENOR_SALARIO, MAIOR_SALARIO) VALUES
(1, 700.00, 1200.00),
(2, 1201.00, 1400.00),
(3, 1401.00, 2000.00),
(4, 2001.00, 3000.00),
(5, 3001.00, 9999.00);


INSERT INTO EMPREGADO (ID_EMPREGADO, NM_EMPREGADO, FUNCAO, LIDER, DATA_CONTRATACAO, SALARIO, COMISSAO, ID_DEPARTAMENTO) VALUES
(7839, 'KING', 'PRESIDENTE', NULL, '1981-11-17', 5000.00, NULL, 10); -- KING (PRESIDENTE) não tem líder

INSERT INTO EMPREGADO (ID_EMPREGADO, NM_EMPREGADO, FUNCAO, LIDER, DATA_CONTRATACAO, SALARIO, COMISSAO, ID_DEPARTAMENTO) VALUES
(7566, 'JONES', 'GERENTE', 7839, '1981-07-02', 2975.00, NULL, 20),   -- JONES reporta a KING
(7698, 'BLAKE', 'GERENTE', 7839, '1981-05-01', 2850.00, NULL, 30),   -- BLAKE reporta a KING
(7782, 'CLARK', 'GERENTE', 7839, '1981-06-09', 2450.00, NULL, 10);   -- CLARK reporta a KING

INSERT INTO EMPREGADO (ID_EMPREGADO, NM_EMPREGADO, FUNCAO, LIDER, DATA_CONTRATACAO, SALARIO, COMISSAO, ID_DEPARTAMENTO) VALUES
(7788, 'SCOTT', 'ANALISTA', 7566, '1982-12-09', 3000.00, NULL, 20),  -- SCOTT reporta a JONES
(7902, 'FORD', 'ANALISTA', 7566, '1981-12-03', 3000.00, NULL, 20);   -- FORD reporta a JONES

INSERT INTO EMPREGADO (ID_EMPREGADO, NM_EMPREGADO, FUNCAO, LIDER, DATA_CONTRATACAO, SALARIO, COMISSAO, ID_DEPARTAMENTO) VALUES
(7499, 'ALLEN', 'VENDEDOR', 7698, '1981-02-20', 1600.00, 300.00, 30), -- ALLEN reporta a BLAKE
(7521, 'WARD', 'VENDEDOR', 7698, '1981-02-22', 1250.00, 500.00, 30),  -- WARD reporta a BLAKE
(7654, 'MARTIN', 'VENDEDOR', 7698, '1981-09-28', 1250.00, 1400.00, 30),-- MARTIN reporta a BLAKE
(7844, 'TURNER', 'VENDEDOR', 7698, '1981-09-08', 1500.00, 0.00, 30),  -- TURNER reporta a BLAKE
(7900, 'JAMES', 'ESCRITURÁRIO', 7698, '1981-12-03', 950.00, NULL, 30);-- JAMES reporta a BLAKE

INSERT INTO EMPREGADO (ID_EMPREGADO, NM_EMPREGADO, FUNCAO, LIDER, DATA_CONTRATACAO, SALARIO, COMISSAO, ID_DEPARTAMENTO) VALUES
(7876, 'ADAMS', 'ESCRITURÁRIO', 7788, '1983-01-12', 1100.00, NULL, 20), -- ADAMS reporta a SCOTT
(7934, 'MILLER', 'ESCRITURÁRIO', 7782, '1982-01-23', 1300.00, NULL, 10);-- MILLER reporta a CLARK

INSERT INTO EMPREGADO (ID_EMPREGADO, NM_EMPREGADO, FUNCAO, LIDER, DATA_CONTRATACAO, SALARIO, COMISSAO, ID_DEPARTAMENTO) VALUES
(7369, 'SMITH', 'ESCRITURÁRIO', 7902, '1980-12-17', 800.00, NULL, 20); -- SMITH reporta a FORD


SELECT NM_EMPREGADO FROM EMPREGADO WHERE ID_EMPREGADO<8000;
SELECT * FROM EMPREGADO;
SELECT * FROM GRADE_SALARIAL;


SELECT nm_empregado, funcao, salario
FROM empregado
WHERE nm_empregado LIKE '%s%';

SELECT nm_empregado
FROM empregado
WHERE nm_empregado LIKE 'M_LLER';


SELECT nm_empregado, funcao, salario
FROM empregado
WHERE comissao IS NULL;


SELECT nm_empregado, funcao, salario, id_departamento
FROM empregado
WHERE id_departamento IN (10,30)
order by id_departamento;


select nm_empregado, id_empregado
from empregado
where id_empregado = null or id_empregado>=0;

